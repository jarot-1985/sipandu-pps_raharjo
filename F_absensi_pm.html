<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Absensi PM - SIPANDU</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Plus Jakarta Sans', system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji"; }
  </style>
</head>
<body class="bg-slate-50 text-slate-800">
  <div class="max-w-5xl mx-auto p-6 md:p-10">
    <!-- Header -->
    <div class="mb-6">
      <div class="flex items-center gap-3 mb-2">
        <div class="w-10 h-10 rounded-xl bg-orange-500 text-white flex items-center justify-center font-black">AP</div>
        <div>
          <h1 class="text-xl md:text-2xl font-black">Absensi PM</h1>
          <p class="text-[10px] md:text-xs font-black uppercase tracking-widest text-orange-600">Input dan Riwayat</p>
        </div>
      </div>
      <p class="text-slate-500 text-sm">Form ini menampung data absensi penerima manfaat per periode.</p>
    </div>

    <!-- Card Form -->
    <div class="bg-white rounded-[2rem] border border-slate-200 shadow-sm overflow-hidden">
      <div class="p-6 md:p-8 space-y-6">
        <h2 class="text-lg md:text-xl font-black text-slate-800">Input Absensi PM</h2>
        <form id="absensiForm" class="space-y-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="unitPelayanan" class="block text-[10px] font-black text-slate-500 uppercase tracking-widest mb-2">Unit Pelayanan</label>
              <select id="unitPelayanan" name="unitPelayanan" class="w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl outline-none font-bold text-sm focus:border-orange-500" required>
                <option value="">Pilih Unit Pelayanan...</option>
                <option value="PPSDI Raharjo Sragen">PPSDI Raharjo Sragen</option>
                <option value="RPSLU Mojomulyo Sragen">RPSLU Mojomulyo Sragen</option>
                <option value="RPSA Pamardi Siwi Sragen">RPSA Pamardi Siwi Sragen</option>
                <option value="RPS PMKS Gondang">RPS PMKS Gondang</option>
              </select>
            </div>
            <div>
              <label for="bulanTahun" class="block text-[10px] font-black text-slate-500 uppercase tracking-widest mb-2">Bulan dan Tahun</label>
              <input id="bulanTahun" type="month" name="bulanTahun" class="w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl outline-none font-bold text-sm focus:border-orange-500" required />
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="periodeLaporan" class="block text-[10px] font-black text-slate-500 uppercase tracking-widest mb-2">Periode Laporan</label>
              <select id="periodeLaporan" name="periodeLaporan" class="w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl outline-none font-bold text-sm focus:border-orange-500" required>
                <option value="">Pilih Periode...</option>
                <option value="I (Satu)">I (Satu)</option>
                <option value="II (Dua)">II (Dua)</option>
                <option value="III (Tiga)">III (Tiga)</option>
              </select>
            </div>
            <div>
              <label for="keterangan" class="block text-[10px] font-black text-slate-500 uppercase tracking-widest mb-2">Keterangan</label>
              <input id="keterangan" name="keterangan" placeholder="Opsional" class="w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl outline-none font-bold text-sm focus:border-orange-500" />
            </div>
          </div>

          <div class="grid grid-cols-2 md:grid-cols-3 gap-5 bg-slate-50 p-6 rounded-2xl border border-slate-100">
            <div class="space-y-1.5">
              <label for="pmLaki" class="text-[10px] font-black text-slate-500 uppercase">PM Laki-Laki</label>
              <input id="pmLaki" type="number" name="pmLaki" placeholder="0" class="w-full p-3 bg-white border border-slate-200 rounded-lg outline-none font-black text-sm text-center focus:border-orange-500" required />
            </div>
            <div class="space-y-1.5">
              <label for="pmPerempuan" class="text-[10px] font-black text-slate-500 uppercase">PM Perempuan</label>
              <input id="pmPerempuan" type="number" name="pmPerempuan" placeholder="0" class="w-full p-3 bg-white border border-slate-200 rounded-lg outline-none font-black text-sm text-center focus:border-orange-500" required />
            </div>
            <div class="col-span-2 md:col-span-1 space-y-1.5">
              <label class="text-[10px] font-black text-orange-600 uppercase block text-center">Total PM</label>
              <div id="totalPm" class="w-full p-3 bg-orange-500 text-white rounded-lg font-black text-sm text-center shadow-md">0 Org</div>
            </div>
          </div>

          <div class="space-y-3">
            <label class="block text-[10px] font-black text-slate-500 uppercase tracking-widest">Lampiran PDF (opsional)</label>
            <input id="pdfFile" type="file" accept="application/pdf,.pdf" class="block w-full text-sm text-slate-600 file:mr-4 file:py-2.5 file:px-4 file:rounded-lg file:border-0 file:text-xs file:font-black file:bg-orange-50 file:text-orange-600 hover:file:bg-orange-100" />
            <p id="pdfInfo" class="text-[10px] font-bold text-slate-400">Maksimal 2MB</p>
          </div>

          <div class="flex gap-3 pt-2">
            <button type="reset" class="px-5 py-3 bg-slate-100 text-slate-600 rounded-xl font-black text-[10px] uppercase hover:bg-slate-200">Reset</button>
            <button type="submit" class="px-6 py-3 bg-slate-900 text-white rounded-xl font-black text-[10px] uppercase tracking-widest hover:bg-orange-600">Simpan</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Riwayat (dummy lokal) -->
    <div class="mt-6 bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden">
      <div class="p-6 md:p-8">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-sm md:text-base font-black">Riwayat Input (Lokal)</h3>
          <span class="text-[10px] font-black uppercase tracking-widest text-slate-400">Preview</span>
        </div>
        <div class="overflow-x-auto">
          <table class="w-full min-w-[800px]">
            <thead>
              <tr class="bg-slate-50 border-b text-[10px] font-black text-slate-400 uppercase tracking-widest">
                <th class="p-3 text-left">Unit</th>
                <th class="p-3 text-center">Periode</th>
                <th class="p-3 text-center">Laki</th>
                <th class="p-3 text-center">Perempuan</th>
                <th class="p-3 text-center">Total</th>
                <th class="p-3 text-left">Keterangan</th>
                <th class="p-3 text-center">PDF</th>
              </tr>
            </thead>
            <tbody id="historyBody" class="divide-y divide-slate-100">
              <tr>
                <td colspan="7" class="p-8 text-center text-slate-500">Belum ada data.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>
    const form = document.getElementById('absensiForm');
    const pmL = document.getElementById('pmLaki');
    const pmP = document.getElementById('pmPerempuan');
    const totalEl = document.getElementById('totalPm');
    const pdfEl = document.getElementById('pdfFile');
    const pdfInfo = document.getElementById('pdfInfo');
    const historyBody = document.getElementById('historyBody');

    function updateTotal() {
      const l = parseInt(pmL.value) || 0;
      const p = parseInt(pmP.value) || 0;
      totalEl.textContent = (l + p) + ' Org';
    }

    pmL.addEventListener('input', updateTotal);
    pmP.addEventListener('input', updateTotal);

    form.addEventListener('reset', () => setTimeout(updateTotal, 0));

    pdfEl.addEventListener('change', () => {
      const f = pdfEl.files && pdfEl.files[0];
      if (!f) { pdfInfo.textContent = 'Maksimal 2MB'; return; }
      if (f.type !== 'application/pdf') { pdfInfo.textContent = 'File harus PDF'; pdfEl.value=''; return; }
      if (f.size > 2 * 1024 * 1024) { pdfInfo.textContent = 'Ukuran PDF > 2MB'; pdfEl.value=''; return; }
      pdfInfo.textContent = 'PDF: ' + f.name;
    });

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const fd = new FormData(form);
      const data = Object.fromEntries(fd.entries());
      data.pmLaki = Number(data.pmLaki)||0;
      data.pmPerempuan = Number(data.pmPerempuan)||0;
      data.totalPm = data.pmLaki + data.pmPerempuan;
      const f = pdfEl.files && pdfEl.files[0];
      data.pdfName = f ? f.name : '';

      // Simpan ke riwayat lokal (demo)
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td class="p-3 font-bold text-slate-700">${data.unitPelayanan}</td>
        <td class="p-3 text-center text-slate-600 text-sm">${data.bulanTahun} - ${data.periodeLaporan}</td>
        <td class="p-3 text-center">${data.pmLaki}</td>
        <td class="p-3 text-center">${data.pmPerempuan}</td>
        <td class="p-3 text-center font-black">${data.totalPm}</td>
        <td class="p-3 text-slate-600">${data.keterangan || '-'}</td>
        <td class="p-3 text-center text-xs">${data.pdfName || '-'}</td>
      `;
      if (historyBody.children.length === 1) historyBody.innerHTML = '';
      historyBody.prepend(tr);

      form.reset();
      updateTotal();
    });

    updateTotal();
  </script>
</body>
</html>